A. Customer Nodes Exploration
-- 1. How many unique nodes are there on the Data Bank system?
SELECT COUNT(DISTINCT node_id) AS unique_nodes
FROM customer_nodes;

-- 2. What is the number of nodes per region?
SELECT cn.region_id, r.region_name, COUNT(cn.node_id) AS nodes
FROM customer_nodes cn
JOIN regions r ON cn.region_id=r.region_id
GROUP BY cn.region_id;

-- 3. How many customers are allocated to each region?
SELECT cn.region_id, r.region_name, COUNT(DISTINCT cn.customer_id) AS customer_count
FROM customer_nodes cn
JOIN regions r ON cn.region_id=r.region_id
GROUP BY cn.region_id;

***-- 4. How many days on average are customers reallocated to a different node?
***-- 5. What is the median, 80th and 95th percentile for this same reallocation days metric for each region?


B. Customer Transactions
-- 1. What is the unique count and total amount for each transaction type?
SELECT txn_type, COUNT(txn_type) AS transaction_count, SUM(txn_amount) AS transaction_totals
FROM customer_transactions
GROUP BY txn_type;

-- 2. What is the average total historical deposit counts and amounts for all customers?
-- 3. For each month - how many Data Bank customers make more than 1 deposit and either 1 purchase or 1 withdrawal in a single month?
-- 4. What is the closing balance for each customer at the end of the month?
-- 5. What is the percentage of customers who increase their closing balance by more than 5%?

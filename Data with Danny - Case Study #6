-- A. Digital Analysis
-- 1. How many users are there?

SELECT COUNT(DISTINCT user_id) FROM clique_bait.users;

-- 2. How many cookies does each user have on average?

WITH CTE AS
(
SELECT user_id, COUNT(cookie_id) as cookie_count
FROM clique_bait.users
GROUP BY user_id
)
SELECT AVG(cookie_count) FROM CTE

-- 3. What is the unique number of visits by all users per month?

What is the number of events for each event type?
What is the percentage of visits which have a purchase event?
What is the percentage of visits which view the checkout page but do not have a purchase event?
What are the top 3 pages by number of views?
What is the number of views and cart adds for each product category?
What are the top 3 products by purchases?
